
# To run self hosted on ubuntu 20.04: apt install build-essential

name: Continues Delivery

on:
     push:
     pull_request:

jobs:
     testUsingServer:
          runs-on: self-hosted
          steps:
               - uses: actions/checkout@v3
               - name: Use Node.js 12.x
                 uses: actions/setup-node@v3
                 with:
                    node-version: 12.x
                    cache: 'npm'
               - name: Use Python 2.7
                 uses: actions/setup-python@v3
                 with:
                    python-version: 2.7
                 env:
                    PYTHON_VERSION: 2.7
               - run: npm ci
               - run: npm i screeps@4.2.14
               - run: npm i ncp@^2.0.0 
               - run: npm i q@^1.5.1
               - run: npm i dotenv@^16.0.1
               - run: npm i screeps-api@1.16.0 
               - run: npm i screepsmod-admin-utils@1.28.1 
               - run: npm i screepsmod-auth@2.6.2
               - run: set BUILD_MINUTES=60
               - run: npm run test-server
